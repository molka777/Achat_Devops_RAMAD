version: '3'
services:
 mysql:
  container_name: sqldb
  image: mysql:8.0
  restart: always
  ports:
   - 3306:3306
  environment:
   MYSQL_ROOT_PASSWORD: root
   MYSQL_DATABASE: achatdb
  volumes:
   - mysql-data:/var/lib/mysql
 spring-app:
  container_name: spring_back
  image: ratatouka/achat:latest
  restart: always
  ports:
   - 8089:8089
  depends_on:
   - mysql
  environment:
   SPRING_APPLICATION_JSON: '{
        "spring.datasource.url"  : "jdbc:mysql://hostname:3306/test?useSSL=false",
        "spring.datasource.username" : "root",
        "spring.datasource.password" : "",
        "spring.jpa.properties.hibernate.dialect" : "org.hibernate.dialect.MySQL5InnoDBDialect",
        "spring.jpa.hibernate.ddl-auto" : "update"
      }'
  stdin_open: true
  tty: true
volumes:
 mysql-data:
